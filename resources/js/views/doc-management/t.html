<!-- eslint-disable camelcase -->
<!-- eslint-disable vue/component-api-style -->

<!-- Old version -->

<script>
    import axios from 'axios' // Make sure to install Axios if you haven't already
    
    const csrf_token = document.getElementsByName("csrf-token")
    
    export default {
      data () {
        return {
          count: 0,
          files: [],
          search: '',
          headers: [
            {
              align: 'start',
              key: 'name',
              sortable: false,
              title: 'Customer Name',
            },
            { key: 'Passport', title: 'Passport' },
            { key: 'Visa', title: 'VISA' },
            { key: 'TravelInsurance', title: 'Travel Insurance' },
            { key: 'DateModified', title: 'Date Modified' },
            { key: 'Uuid', title: 'UUID' },
          ],
          customer: [
            {
              name: 'Gago ka ba boss?',
              Passport: 159,
              Visa: 6.0,
              TravelInsurance: 24,
              DateModified: 4.0,
              Uuid: 1,
            },
            {
              name: 'Kupal ka ba boss?',
              Passport: 237,
              Visa: 9.0,
              TravelInsurance: 37,
              DateModified: 4.3,
              Uuid: 1,
            },
            {
              name: 'Tanga ka ba boss?',
              Passport: 262,
              Visa: 16.0,
              TravelInsurance: 23,
              DateModified: 6.0,
              Uuid: 7,
            },
          ],
        }
      },
    
      //METHODS
      methods: {
        say(message){
          alert(message)
        },
        triggerUploadFile(){
          axios.post("/admin/upload", {}, {
            headers: {
              'X-CSRF-TOKEN': csrf_token[0].content,
            },
          }).then(function (res){
    
          })
        },
      },
    }
    </script>
    
    <template>
      <VCard
        title="Customer Document Storage"
        flat
      >
        <template #text>
          <VTextField
            v-model="search"
            label="Search"
            prepend-inner-icon="mdi-magnify"
            variant="outlined"
            hide-details
            single-line
          />
    
          <VFileInput
            v-model="files"
            :show-size="1000"
            color="deep-purple-accent-4"
            label="File input"
            placeholder="Select your files"
            prepend-icon="mdi-paperclip"
            variant="outlined"
            counter
            multiple
          >
            <template #selection="{ fileNames }">
              <template
                v-for="(fileName, index) in fileNames"
                :key="fileName"
              >
                <VChip
                  v-if="index < 2"
                  class="me-2"
                  color="deep-purple-accent-4"
                  size="small"
                  label
                >
                  {{ fileName }}
                </VChip>
    
                <span
                  v-else-if="index === 2"
                  class="text-overline text-grey-darken-3 mx-2"
                >
                  +{{ files.length - 2 }} File(s)
                </span>
              </template>
            </template>
          </VFileInput>
        </template>
    
        <VDataTable
          :headers="headers"
          :items="customer"
          :search="search"
        />
    
        <div class=" pl-10 mb-25 pb-10">
          <!-- Flex container for alignment -->
          <VBtn @click="triggerUploadFile">
            Upload File
          </VBtn>
        </div>
      </VCard>
    </template>
    

    <!-- New version -->
    <script setup>
      import { ref } from 'vue'
      
      const uploadFile = () => {
        // Logic for uploading a file
        // You can use an input element to select files or handle the file upload logic here
        console.log("Upload file function triggered");
        // Example: you might want to show a file input dialog
        const fileInput = document.createElement('input');
        fileInput.type = 'file';
        fileInput.onchange = (event) => {
          const file = event.target.files[0];
          if (file) {
            // Handle the file upload logic here
            console.log(`Uploading file: ${file.name}`);
            // You can use FormData to send the file to your server
            const formData = new FormData();
            formData.append('file', file);
      
            // Example: Use fetch or axios to send the file
            // fetch('your-upload-endpoint', {
            //   method: 'POST',
            //   body: formData,
            // })
            // .then(response => response.json())
            // .then(data => {
            //   console.log('Success:', data);
            // })
            // .catch(error => {
            //   console.error('Error:', error);
            // });
      
            // Close the dialog after uploading
            dialog.value = false; // Close dialog after upload
          }
        };
        fileInput.click(); // Trigger the file input dialog
      };
      
      const navigationTab = ref('Supplier') // Default selected tab
      const dialog = ref(false)
      const tabItems = [
        'Supplier',
        'Vendor',
        'Client', // Updated tab name
      ]
      
      // Additional specific button labels for each tab
      const buttonLabelMap = {
        Supplier: 'Upload File',
        Vendor: 'Upload File',
        Client: 'Upload File', // Updated button label
      }
      
      const search = ref('')
      
      // Define headers and datasets for each tab
      const headersMap = {
        Supplier: [
          {
            align: 'start',
            key: 'name',
            sortable: false,
            title: 'Supplier File',
          },
          { key: 'owner', title: 'Owner' },
          { key: 'expiration', title: 'Expiration Date' },
          { key: 'date_modified', title: 'Date Modified' },
          { key: 'uuid', title: 'UUID' },
        ],
        Vendor: [
          {
            align: 'start',
            key: 'name',
            sortable: false,
            title: 'Vendor File',
          },
          { key: 'owner', title: 'Owner' },
          { key: 'expiration', title: 'Expiration Date' },
          { key: 'date_modified', title: 'Date Modified' },
          { key: 'uuid', title: 'UUID' },
        ],
        Client: [ // Updated header for Client
          {
            align: 'start',
            key: 'name',
            sortable: false,
            title: 'Insurance File',
          },
          { key: 'owner', title: 'Owner' },
          { key: 'expiration', title: 'Expiration Date' },
          { key: 'date_modified', title: 'Date Modified' },
          { key: 'uuid', title: 'UUID' },
        ],
      }
      
      // Define data for each tab
      const itemsMap = {
        Supplier: [
          {
            name: 'Frozen Yogurt',
            owner: 'John Doe',
            expiration: '2025-12-31',
            date_modified: '2024-09-24',
            uuid: '1234-5678-9012',
          },
          {
            name: 'Ice Cream Sandwich',
            owner: 'Jane Smith',
            expiration: '2026-01-15',
            date_modified: '2024-09-20',
            uuid: '2234-5678-9012',
          },
        ],
        Vendor: [
          {
            name: 'Vendor Application 1',
            owner: 'Alice Johnson',
            expiration: '2025-11-30',
            date_modified: '2024-09-15',
            uuid: '3234-5678-9012',
          },
          {
            name: 'Vendor Application 2',
            owner: 'Bob Brown',
            expiration: '2026-02-28',
            date_modified: '2024-09-10',
            uuid: '4234-5678-9012',
          },
        ],
        Client: [ // Updated data for Client
          {
            name: 'Travel Insurance A',
            owner: 'Charlie Green',
            expiration: '2025-08-15',
            date_modified: '2024-09-05',
            uuid: '5234-5678-9012',
          },
          {
            name: 'Travel Insurance B',
            owner: 'Dana White',
            expiration: '2026-05-01',
            date_modified: '2024-09-01',
            uuid: '6234-5678-9012',
          },
          
        ],
      }
      </script>
      
      <template>
        <VRow>
          <VCol md="12" cols="12">
            <VCard>
              <!-- Tabs Navigation -->
              <VTabs v-model="navigationTab">
                <VTab
                  v-for="item in tabItems"
                  :key="item"
                  :value="item"
                >
                  {{ item }}
                </VTab>
              </VTabs>
      
              <VDivider />
      
              <!-- Tabs Content -->
              <VWindow v-model="navigationTab">
                <VWindowItem
                  v-for="item in tabItems"
                  :key="item"
                  :value="item"
                >
                  <VCardItem>
                    <VCardTitle>{{ item }} Details</VCardTitle>
                  </VCardItem>
      
                  <VCardText>
                    <VTextField
                      v-model="search"
                      :label="`Search for ${item} Files`"
                      prepend-inner-icon="mdi-magnify"
                      variant="outlined"
                      hide-details
                      single-line
                      class="mx-auto"
                      style="max-width: 100%"
                    />
      
                    <VDataTable
                      :headers="headersMap[item]"
                      :items="itemsMap[item]"
                      :search="search"
                      item-value="name"
                    />
                  </VCardText>
      
                  <VCardText >
                    <div>
                      <v-dialog v-model="dialog" max-width="500" persistent>
        <template v-slot:activator="{ props: activatorProps }">
          <v-btn v-bind="activatorProps"> Upload File </v-btn>
        </template>
      
        <v-card title="UPLOAD FILE" style="align-items: center;">
          <template v-slot:actions>
            <v-row justify="space-between" style="margin-top: 25px; margin-bottom: 25px;">
              <v-col class="d-flex justify-start">
                <v-btn
                  @click="dialog = false"
                  style="width: 200px; height: 200px;"
                >
                  <template #prepend>
                    <v-icon class="" icon="bx-scan" size="50" />
                  </template>
                </v-btn>
              </v-col>
      
              <v-col class="d-flex justify-end">
                <v-btn
                  @click="uploadFile"
                  style="width: 200px; height: 200px;"
                >
                  <template #prepend>
                    <v-icon class="" icon="bx-folder" size="50" />
                  </template>
                </v-btn>
              </v-col>
            </v-row>
          </template>
        </v-card>
      </v-dialog>
        </div>
                  </VCardText>
                </VWindowItem>
              </VWindow>
            </VCard>
          </VCol>
        </VRow>
      </template>
      
      
      